<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>诊断结果</title>
    <!-- Base Styling  -->
    <link rel="stylesheet" type="text/css" href="../static/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/main/css/fonts.css">
    <link rel="stylesheet" href="../static/main/css/style.css">
</head>

<body>
    <div id="main-wrapper" class="show">


        <!-- start logo components 开始的名字与logo -->
        <div class="nav-header">
            <div class="brand-logo">
                <a href="/index/"> <img class="logo-tabib" src="../static/images/logo3.png" alt=""></a>
                <a href="/index/"><img class="brand-title" src="../static/images/logo4.png" alt=""></a>
            </div>
        </div>
        <!-- End logo components -->


    <!-- start section sidebar -->
    <aside class="left-panel nicescroll-box">
        <nav class="navigation">
            <ul class="list-unstyled main-menu">
                <li class="has-submenu active">
                    <a href="/index/">
                        <i class="fas fa-th-large"></i>
                        <span class="nav-label">医生首页</span>
                    </a>
                </li>

                <li class="has-submenu">
                    <a href="#" class="has-arrow mm-collapsed">
                        <i class="fas fa-users"></i>
                        <span class="nav-label">患者情况</span>
                    </a>
                    <ul class="list-unstyled mm-collapse">
                        <li><a href="/new_patient/">新增患者</a></li>
                        <li><a href="/all_patient/">所有患者</a></li>
                    </ul>
                </li>


                <li class="has-submenu active">
                    <a href="#">
                        <i class="fas fa-cog"></i>
                        <span class="nav-label">帮助</span>
                    </a>

                </li>

            </ul>
        </nav>
        <div class="sidebar-widgets">
            <div class="top-sidebar box-shadow mx-25 m-b-30 p-b-20 text-center">
                <a href="/rapid_diagnosis/"> <!--应该是快速诊断的网页url-->
                    <img src="../static/images/appointement.svg" class="side-img" alt="img">
                </a>
                <a href="/rapid_diagnosis/">
                    <h4 class="text-primary mb-0">快速诊断</h4>
                </a>
            </div>
            <div class="copyright text-center">
                <p class="mb-0"> 首页</p>
                <p class="mb-0"> © 2023 </p>
            </div>
        </div>
    </aside>
    <!-- End section sidebar -->


    <!-- start section header -->
    <div class="header">
        <header class="top-head container-fluid">
            <div class="nav-control">
                <div class="hamburger">
                    <span class="line"></span><span class="line"></span><span class="line"></span>
                </div>
                <div class="left-header content-header__menu">
                    <ul class="list-unstyled">
                        <li class="nav-link btn">
                            <a href="/rapid_diagnosis/"><i class="far fa-eye"></i> <span> 快速诊断</span></a>
                        </li>
                        <li class="nav-link btn">
                            <a href="/new_patient/"><i class="far fa-file-alt"></i> <span> 新增患者</span></a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="header-right">
                <div class="fullscreen notification_dropdown">
                    <div class="full">
                        <a class="text-dark" href="#!" onclick="javascript:toggleFullScreen()">
                            <i class="fas fa-expand"></i>
                        </a>
                    </div>
                </div>

                <div class="my-account-wrapper">
                    <div class="account-wrapper">
                        <div class="account-control">
                            <a class="login header-profile" href="#" title="Sign in">
                                <div class="header-info">
                                    <span>admin@qq.com</span>
                                    <small>账户</small>
                                </div>
                                <img src="../static/images/client.jpg" alt="people">
                            </a>
                            <div class="account-dropdown-form dropdown-container">
                                <div class="form-content">
                                    <a>
                                        <i class="far fa-user"></i>
                                        <span class="ml-2">简介</span>
                                    </a>
                                    <!--
                                    <a href="#">
                                        <i class="far fa-envelope"></i>
                                        <span class="ml-2">Inbox</span>
                                    </a>
                                    -->
                                    <a href="/login/">
                                        <i class="fas fa-sign-in-alt"></i>
                                        <span class="ml-2">退出 </span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
    </div>
    <!-- End section header -->


    <!-- start section content -->
    <div class="content-body">
        <div class="warper container-fluid">
            <div class="new-patients main_container">
                <div class="row page-titles mx-0">
                    <div class="col-sm-6 p-md-0">
                        <div class="welcome-text">
                            <h4 class="text-primary">诊断报告</h4>
                        </div>
                    </div>
                    <div class="col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                            <li class="breadcrumb-item active"><a href="/new_patient/">Diagnostic results</a></li>
                        </ol>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="basic-form">
                                    <form method="post" action="/new_patient/" enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <div class="row">
                                            <div class="col-sm-6 col-xl-4 col-lg-6">
                                                <div class="widget card card-primary">
                                                    <div class="card-body">
                                                        <div class="media text-center">
                                                                <span>
                                                                    <i class="fas  fa-2x"></i>
                                                                </span>
                                                                <div class="media-body">
                                                                    <span class="text-white fs-4" >DR</span>
                                                                    <h3 class="mb-0 text-white">平均概率：{{ result.DR }}</h3>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 col-xl-4 col-lg-6">
                                                    <div class="widget card card-danger">
                                                        <div class="card-body">
                                                            <div class="media text-center">
                                                                <span>
                                                                    <i class="fas  fa-2x"></i>
                                                                </span>
                                                                <div class="media-body">
                                                                    <span class="text-white fs-4">AMD</span>
                                                                    <h3 class="mb-0 text-white">平均概率：{{ result.AMD }}</h3>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 col-xl-4 col-lg-6">
                                                    <div class="widget card card-primary">
                                                        <div class="card-body">
                                                            <div class="media text-center">
                                                                <span>
                                                                    <i class="fas fa-2x"></i>
                                                                </span>
                                                                <div class="media-body">
                                                                    <span class="text-white fs-4">NORMAL</span>
                                                                    <h3 class="mb-0 text-white">平均概率：{{ result.NORMAL }}</h3>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-lg-12">
                                                    <div class="card shadow widget1">
                                                        <div class="card-header">
                                                            <h4 class="card-title">Result table</h4>
                                                        </div>
                                                        <div class="card-body">
                                                            <canvas id="chart1" width="100%" height="40"></canvas>
                                                        </div>
                                                    </div>
                                                </div>


                                            </div>


                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <!-- End section content -->


    </div>

    <!-- JQuery v3.5.1 -->
    <script src="../static/plugins/jquery/jquery.min.js"></script>

    <!-- popper js -->
    <script src="../static/plugins/popper/popper.min.js"></script>

    <!-- Bootstrap -->
    <script src="../static/plugins/bootstrap/js/bootstrap.js"></script>

    <!-- Moment -->
    <script src="../static/plugins/moment/moment.min.js"></script>

    <!-- Date Range Picker -->
    <script src="../static/plugins/daterangepicker/daterangepicker.min.js"></script>

     <!-- Chart js -->
    <script src="../static/plugins/chart/chart/Chart.min.js"></script>
    <script>
        var chartactivity = document.getElementById('chart1').getContext("2d");
        var gradientStroke = chartactivity.createLinearGradient(200, 0, 100, 0);
        gradientStroke.addColorStop(0, "rgba(58, 233, 245, 1)");
        gradientStroke.addColorStop(1, "rgba(18, 216, 227, 1)");

        var gradientStroke2 = chartactivity.createLinearGradient(200, 0, 100, 0);
        gradientStroke2.addColorStop(0, "rgba(255, 92, 203, 1)");
        gradientStroke2.addColorStop(1, "rgba(253, 133, 168, 1)");

        var gradientStroke3 = chartactivity.createLinearGradient(200, 0, 100, 0);
        gradientStroke3.addColorStop(0, "rgba(80, 152, 100, 1)");
        gradientStroke3.addColorStop(1, "rgba(90, 200, 168, 1)");

        var gradientFill = chartactivity.createLinearGradient(0, 0, 0, 350);
        gradientFill.addColorStop(0, "rgba(128, 182, 244, 0.5)");
        gradientFill.addColorStop(1, "rgba(128, 182, 244, 0)");

        var gradientFill2 = chartactivity.createLinearGradient(0, 0, 0, 350);
        gradientFill2.addColorStop(0, "rgba(255, 91, 204, 0.5)");
        gradientFill2.addColorStop(1, "rgba(255, 91, 204, 0)");

        var gradientFill3 = chartactivity.createLinearGradient(0, 0, 0, 350);
        gradientFill2.addColorStop(0, "rgba(204, 255, 204, 0.5)");
        gradientFill2.addColorStop(1, "rgba(204, 255, 204, 0)");

        var labels = []
        var DR = []
        var AMD = []
        var NORMAL = []

        {% for record in records %}
            DR.push(Number({{ record.DR }}))
            AMD.push(Number({{ record.AMD }}))
            NORMAL.push(Number({{ record.NORMAL }}))
        {% endfor %}

        for(i = 0; i < {{ records.count }}; i++){
            labels.push(i + 1)
        }

        var ActivityChart = new Chart(chartactivity, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: "DR",
                    borderColor: gradientStroke,
                    pointBorderColor: gradientStroke,
                    pointBackgroundColor: "rgba(255, 255, 255, 1)",
                    pointHoverBackgroundColor: "rgba(128, 182, 244, 1)",
                    pointHoverBorderColor: gradientStroke,
                    pointBorderWidth: 1,
                    pointHoverRadius: 3,
                    pointHoverBorderWidth: 1,
                    pointRadius: 3,
                    fill: false,
                    backgroundColor: gradientFill,
                    borderWidth: 2,
                    data: DR
                }, {
                    label: "AMD",
                    borderColor: gradientStroke2,
                    pointBorderColor: gradientStroke2,
                    pointBackgroundColor: "rgba(255, 255, 255, 1)",
                    pointHoverBackgroundColor: "rgba(128, 182, 244, 1)",
                    pointHoverBorderColor: gradientStroke2,
                    pointBorderWidth: 1,
                    pointHoverRadius: 3,
                    pointHoverBorderWidth: 1,
                    pointRadius: 3,
                    fill: false,
                    backgroundColor: gradientFill2,
                    borderWidth: 2,
                    data: AMD
                }, {
                    label: "NORMAL",
                    borderColor: gradientStroke3,
                    pointBorderColor: gradientStroke3,
                    pointBackgroundColor: "rgba(255, 255, 255, 1)",
                    pointHoverBackgroundColor: "rgba(128, 182, 244, 1)",
                    pointHoverBorderColor: gradientStroke3,
                    pointBorderWidth: 1,
                    pointHoverRadius: 3,
                    pointHoverBorderWidth: 1,
                    pointRadius: 3,
                    fill: true,
                    backgroundColor: gradientFill3,
                    borderWidth: 2,
                    data: NORMAL
                }


                ]
            },
            options: {
                legend: {
                    position: "top",
                    labels: {
                        boxWidth: 15,
                        padding: 15
                    }
                },
                scales: {
                    yAxes: [{
                        ticks: {
                            fontColor: "rgba(0,0,0,0.5)",
                            fontStyle: "bold",
                            beginAtZero: true,
                            maxTicksLimit: 5,
                            padding: 20
                        },
                        gridLines: {
                            drawTicks: false,
                            display: false
                        }

                    }],
                    xAxes: [{
                        gridLines: {
                            zeroLineColor: "transparent"
                        },
                        ticks: {
                            padding: 20,
                            fontColor: "rgba(0,0,0,0.5)",
                            fontStyle: "bold"
                        }
                    }]
                }
            }
        });

    </script>
    <!-- Main Custom JQuery -->
    <script src="../static/js/toggleFullScreen.js"></script>
    <script src="../static/js/main.js"></script>

</body>

</html>
